<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë”ê·¸ë€ë–¼ ë©”ë‰´ ê³„ì‚°ê¸°</title>
<style>
:root {
  --main-color: #4caf50;
}
body { font-family:'Arial',sans-serif; margin:0; padding:0; background:#fff; color:#333; text-align:center; transition: background 0.3s, color 0.3s;}
header { background:var(--main-color); color:white; padding:15px 0; font-size:22px; font-weight:bold; position:sticky; top:0; transition: background 0.3s;}
.container { padding:20px; max-width:800px; margin:auto; }
.menu-grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap:15px; margin-bottom:20px;}
.menu-item { border:1px solid #ccc; border-radius:10px; padding:10px; background:#f9f9f9; transition: background 0.3s;}
.menu-item p { margin:5px 0; font-weight:bold; }
.menu-item button, .menu-item input { width:100%; margin:5px 0; padding:8px; font-size:16px; border-radius:6px; border:1px solid #ccc; transition: transform 0.1s;}
.menu-item button:active { transform: scale(1.05);}
button { background:var(--main-color); color:white; border:none; cursor:pointer; transition: background 0.2s, transform 0.1s; }
button:hover { background: #45a049; }
.reset { background:#e53935; }
.reset:hover { background:#d32f2f; }
#total { font-size:20px; font-weight:bold; margin:20px 0; transition: color 0.3s;}
.receipt, .history { text-align:left; max-width:500px; margin:20px auto; border:1px solid #ccc; padding:15px; border-radius:10px; background:#f9f9f9; opacity:0; transform: translateY(-20px); transition: opacity 0.4s, transform 0.4s;}
.receipt.show, .history.show { opacity:1; transform: translateY(0);}
.receipt h2, .history h3 { text-align:center; }
.datetime { font-size:14px; color:#555; text-align:center; margin-bottom:10px; }
.category-title { font-weight:bold; margin-top:10px; }
.history-entry { border:1px solid #ddd; padding:10px; border-radius:8px; margin-bottom:10px; background:#fafafa; }
.theme-select { margin:15px 0; }
@media (max-width:480px){
  .menu-item button, .menu-item input { font-size:14px; padding:6px;}
  header { font-size:18px; padding:12px 0;}
}
</style>
</head>
<body>
<header>ë”ê·¸ë€ë–¼ ë©”ë‰´ ê³„ì‚°ê¸°</header>
<div class="container">

<div class="theme-select">
<label for="theme">í…Œë§ˆ ì„ íƒ: </label>
<select id="theme" onchange="changeTheme(this.value)">
<option value="#4caf50">ê¸°ë³¸ (ë…¹ìƒ‰)</option>
<option value="#9c27b0">ë³´ë¼</option>
<option value="#ff9800">ì£¼í™©</option>
<option value="#2196f3">íŒŒë‘</option>
</select>
</div>

<h2>ğŸ¥¤ ìŒë£Œ</h2>
<div class="menu-grid">
  <div class="menu-item">
    <p>ì•„ë©”ë¦¬ì¹´ë…¸ (7.5)</p>
    <button onclick="addItem('ì•„ë©”ë¦¬ì¹´ë…¸',7500,'ìŒë£Œ')">+1</button>
    <input type="number" id="qty-ì•„ë©”ë¦¬ì¹´ë…¸" value="1" min="1">
    <button onclick="addItemDirect('ì•„ë©”ë¦¬ì¹´ë…¸',7500,'ìŒë£Œ')">ì¶”ê°€</button>
  </div>
  <div class="menu-item">
    <p>ì¹´í˜ë¼ë–¼ (5.5)</p>
    <button onclick="addItem('ì¹´í˜ë¼ë–¼',5500,'ìŒë£Œ')">+1</button>
    <input type="number" id="qty-ì¹´í˜ë¼ë–¼" value="1" min="1">
    <button onclick="addItemDirect('ì¹´í˜ë¼ë–¼',5500,'ìŒë£Œ')">ì¶”ê°€</button>
  </div>
</div>

<h2>ğŸ° ë””ì €íŠ¸</h2>
<div class="menu-grid">
  <div class="menu-item">
    <p>ì™€í”Œ (7.0)</p>
    <button onclick="addItem('ì™€í”Œ',7000,'ë””ì €íŠ¸')">+1</button>
    <input type="number" id="qty-ì™€í”Œ" value="1" min="1">
    <button onclick="addItemDirect('ì™€í”Œ',7000,'ë””ì €íŠ¸')">ì¶”ê°€</button>
  </div>
</div>

<div>
<label for="membership">ë©¤ë²„ì‹­ ì„ íƒ: </label>
<select id="membership">
<option value="0">ì—†ìŒ</option>
<option value="0.10">í”ŒëŸ¬ìŠ¤ (10% í• ì¸)</option>
<option value="0.20">ì˜¤ë¦¬ì§„ (20% í• ì¸)</option>
</select>
</div>

<div id="total">ì´ ê¸ˆì•¡: 0ì›</div>
<button class="reset" onclick="resetTotal()">ì´ˆê¸°í™”</button>
<button onclick="printReceipt()">ì˜ìˆ˜ì¦ ì¶œë ¥</button>
<button onclick="showHistory()">ì˜ìˆ˜ì¦ ê¸°ë¡ ë³´ê¸°</button>

<div id="receipt" class="receipt">
<h2>ì˜ìˆ˜ì¦</h2>
<div class="datetime" id="receiptDate"></div>
<div id="receiptList"></div>
<p id="receiptTotal"></p>
<p id="receiptDiscount"></p>
<p id="receiptFinal"></p>
</div>

<div id="history" class="history">
<h3>ğŸ“œ ì˜ìˆ˜ì¦ ê¸°ë¡</h3>
<div style="text-align:center; margin-bottom:10px;">
<button onclick="deleteLastReceipt()">ìµœê·¼ ì˜ìˆ˜ì¦ ì‚­ì œ</button>
<button class="reset" onclick="clearHistory()">ì „ì²´ ê¸°ë¡ ì‚­ì œ</button>
<button onclick="undoDelete()">ë˜ëŒë¦¬ê¸°</button>
</div>
<div id="historyList"></div>
</div>

</div>

<script>
//=== í…Œë§ˆ ë³€ê²½
function changeTheme(color){
document.documentElement.style.setProperty('--main-color',color);
}

//=== ê³„ì‚°ê¸° ë¡œì§
let total=0, items={}, lastDeleted=null;

function addItem(name, price, category){
if(items[name]) items[name].count++;
else items[name]={price, count:1, category};
total+=price; updateDisplay();
}

function addItemDirect(name, price, category){
let qty=parseInt(document.getElementById("qty-"+name).value)||1;
if(items[name]) items[name].count+=qty;
else items[name]={price,count:qty,category};
total+=price*qty; updateDisplay();
}

function updateDisplay(){document.getElementById("total").innerText=`ì´ ê¸ˆì•¡: ${total.toLocaleString()}ì›`; }
function resetTotal(){total=0; items={}; updateDisplay(); document.getElementById("receipt").classList.remove("show");}

function printReceipt(){
const now=new Date(); const dateStr=now.toLocaleDateString("ko-KR"); const timeStr=now.toLocaleTimeString("ko-KR");
document.getElementById("receiptDate").innerText=`${dateStr} ${timeStr}`;
let receiptList=document.getElementById("receiptList"); receiptList.innerHTML="";
let categories={"ìŒë£Œ":[], "ë””ì €íŠ¸":[]};
for(let item in items){
let subtotal=items[item].price*items[item].count;
categories[items[item].category].push(`${item} Ã— ${items[item].count} = ${subtotal.toLocaleString()}ì›`);
}
for(let cat in categories){
if(categories[cat].length>0){
let catTitle=document.createElement("p"); catTitle.className="category-title"; catTitle.innerText=`[${cat}]`; receiptList.appendChild(catTitle);
let ul=document.createElement("ul"); categories[cat].forEach(txt=>{let li=document.createElement("li"); li.textContent=txt; ul.appendChild(li);}); receiptList.appendChild(ul);
}
}
let membership=parseFloat(document.getElementById("membership").value);
let discountAmount=total*membership;
let finalTotal=total-discountAmount;
document.getElementById("receiptTotal").innerText=`ì´ ê¸ˆì•¡: ${total.toLocaleString()}ì›`;
document.getElementById("receiptDiscount").innerText=`í• ì¸ ê¸ˆì•¡: ${discountAmount.toLocaleString()}ì›`;
document.getElementById("receiptFinal").innerText=`ìµœì¢… ê²°ì œ ê¸ˆì•¡: ${finalTotal.toLocaleString()}ì›`;
document.getElementById("receipt").classList.add("show");

// ê¸°ë¡ ì €ì¥
let history=JSON.parse(localStorage.getItem("receiptHistory")||"[]");
history.push({date:`${dateStr} ${timeStr}`, items:JSON.parse(JSON.stringify(items)), total, discountAmount, finalTotal});
localStorage.setItem("receiptHistory", JSON.stringify(history));
}

//=== ê¸°ë¡ í‘œì‹œ
function showHistory(){
let historyDiv=document.getElementById("history");
let historyList=document.getElementById("historyList"); historyList.innerHTML="";
let history=JSON.parse(localStorage.getItem("receiptHistory")||"[]");
if(history.length===0){historyList.innerHTML="<p>ì €ì¥ëœ ì˜ìˆ˜ì¦ì´ ì—†ìŠµë‹ˆë‹¤.</p>";}
else{history.forEach(rec=>{
let entry=document.createElement("div"); entry.className="history-entry"; entry.innerHTML=`<strong>${rec.date}</strong><br>`;
let categories={"ìŒë£Œ":[], "ë””ì €íŠ¸":[]};
for(let item in rec.items){
let subtotal=rec.items[item].price*rec.items[item].count;
categories[rec.items[item].category].push(`${item} Ã— ${rec.items[item].count} = ${subtotal.toLocaleString()}ì›`);
}
for(let cat in categories){
if(categories[cat].length>0){
entry.innerHTML+=`<p>[${cat}]</p><ul>${categories[cat].map(x=>`<li>${x}</li>`).join("")}</ul>`;
}
}
entry.innerHTML+=`ì´ ê¸ˆì•¡: ${rec.total.toLocaleString()}ì›<br>í• ì¸ ê¸ˆì•¡: ${rec.discountAmount.toLocaleString()}ì›<br>ìµœì¢… ê²°ì œ ê¸ˆì•¡: ${rec.finalTotal.toLocaleString()}ì›`;
historyList.appendChild(entry);
});}
historyDiv.classList.add("show");
}

//=== ì‚­ì œ ë° ë˜ëŒë¦¬ê¸°
function deleteLastReceipt(){
let history=JSON.parse(localStorage.getItem("receiptHistory")||"[]");
if(history.length===0){alert("ì‚­ì œí•  ì˜ìˆ˜ì¦ì´ ì—†ìŠµë‹ˆë‹¤."); return;}
lastDeleted=history.pop();
localStorage.setItem("receiptHistory", JSON.stringify(history));
showHistory();
alert("ìµœê·¼ ì˜ìˆ˜ì¦ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤. ë˜ëŒë¦¬ê¸°ë¥¼ ëˆŒëŸ¬ ë³µì›í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
}

function clearHistory(){
let history=JSON.parse(localStorage.getItem("receiptHistory")||"[]");
if(history.length===0){alert("ì‚­ì œí•  ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤."); return;}
if(confirm("ì •ë§ ì „ì²´ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")){
lastDeleted=history;
localStorage.removeItem("receiptHistory");
showHistory();
alert("ì „ì²´ ê¸°ë¡ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤. ë˜ëŒë¦¬ê¸°ë¥¼ ëˆŒëŸ¬ ë³µì›í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
}
}

function undoDelete(){
if(!lastDeleted){alert("ë˜ëŒë¦´ ì˜ìˆ˜ì¦ì´ ì—†ìŠµë‹ˆë‹¤."); return;}
let history=JSON.parse(localStorage.getItem("receiptHistory")||"[]");
if(Array.isArray(lastDeleted)){history=history.concat(lastDeleted);}
else{history.push(lastDeleted);}
localStorage.setItem("receiptHistory", JSON.stringify(history));
lastDeleted=null;
showHistory();
alert("ì‚­ì œëœ ì˜ìˆ˜ì¦ì´ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤.");
}
</script>
</body>
</html>
